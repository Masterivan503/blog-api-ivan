generator client {
  provider = "prisma-client"
}

datasource db {
  provider = "mysql"
}

///Tabla de usuarios
model User {
  ///Creamos llave primaria
  user_id  BigInt @id @default(autoincrement())
  name     String @db.VarChar(100)
  email    String @unique @db.VarChar(100)
  password String @db.VarChar(100)

  ///Creamos el campo status para mantenimiento logico
  status Int @default(1) @db.TinyInt

  ///Creamos los campos de crear, actualizar & eliminar
  created_at DateTime  @default(now()) @db.DateTime(6)
  updated_at DateTime  @updatedAt @db.DateTime(6)
  deleted_at DateTime? @db.DateTime(6)

  ///Definimos relaciones
  blogs         Blog[]
  active_tokens active_token[]

  @@map("users")
}

///Tabla categorias
model Category {
  category_id BigInt @id @default(autoincrement())
  nombre      String @db.VarChar(50)

  ///Creamos el campo status para mantenimiento logico
  status Int @default(1) @db.TinyInt

  ///Creamos los campos de crear, actualizar & eliminar
  created_at DateTime  @default(now()) @db.DateTime(6)
  updated_at DateTime  @updatedAt @db.DateTime(6)
  deleted_at DateTime? @db.DateTime(6)

  ///Definimos relaciones
  subcategorys Subcategory[]
  blogs        Blog[]

  @@map("categorys")
}

///Tabla Subcategorias
model Subcategory {
  subcategory_id BigInt @id @default(autoincrement())
  nombre         String @db.VarChar(50)
  category_id    BigInt

  ///Creamos el campo status para mantenimiento logico
  status Int @default(1) @db.TinyInt

  ///Creamos los campos de crear, actualizar & eliminar
  created_at DateTime  @default(now()) @db.DateTime(6)
  updated_at DateTime  @updatedAt @db.DateTime(6)
  deleted_at DateTime? @db.DateTime(6)

  ///Definimos relaciones
  blogs Blog[]

  ///Creamos la relaciones
  categorys Category @relation(fields: [category_id], references: [category_id])

  @@map("subcategorys")
}

///Tabla Blogs
model Blog {
  blog_id        BigInt @id @default(autoincrement())
  titulo         String @db.VarChar(200)
  contenido      String @db.VarChar(255)
  imagen         String @db.VarChar(255)
  user_id        BigInt
  category_id    BigInt
  subcategory_id BigInt
  ///Creamos el campo status para mantenimiento logico
  status         Int    @default(1) @db.TinyInt

  ///Creamos los campos de crear, actualizar & eliminar
  created_at DateTime  @default(now()) @db.DateTime(6)
  updated_at DateTime  @updatedAt @db.DateTime(6)
  deleted_at DateTime? @db.DateTime(6)

  ///Creamos las relaciones user --> category --> subcategory
  users User @relation(fields: [user_id], references: [user_id])

  categorys Category @relation(fields: [category_id], references: [category_id])

  subcategorys Subcategory @relation(fields: [subcategory_id], references: [subcategory_id])

  @@map("blogs")
}

//Tabla active_token
model active_token {
  token_id BigInt @id @default(autoincrement())
  user_id  BigInt
  token    String @db.VarChar(500)
  ///Creamos el campo status para mantenimiento logico
  status   Int    @default(1) @db.TinyInt

  ///Creamos los campos de crear, actualizar & eliminar
  created_at DateTime  @default(now()) @db.DateTime(6)
  updated_at DateTime  @updatedAt @db.DateTime(6)
  deleted_at DateTime? @db.DateTime(6)

  ///Creamos la relacion
  users User @relation(fields: [user_id], references: [user_id])

  @@map("active_tokens")
}
